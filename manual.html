<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css/web_style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ibon Martínez Arranz</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home fa-2x"></span>
     
     Inicio
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-user fa-2x"></span>
     
     Sobre mí
  </a>
</li>
<li>
  <a href="blog.html">
    <span class="fa fa-comment fa-2x"></span>
     
     Blog
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-th-list fa-2x"></span>
     
     Más
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="manual.html">
        <span class="fa fa-book fa-1x"></span>
         
         Manual de R
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="cv.html">
        <span class="fa fa-user fa-1x"></span>
         
         CV
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=martinez-arranz">
    <span class="fa fa-university fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/company/owl">
    <span class="fa fa-linkedin-square fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/imarranz">
    <span class="fa fa-twitter-square fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="http://www.github.com/imarranz">
    <span class="fa fa-github-square fa-2x"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<div id="iniciacion-a-r" class="section level1">
<h1>Iniciación a <code>R</code></h1>
<div id="proyecto-r" class="section level2">
<h2>Proyecto <code>R</code></h2>
<div id="que-es-r" class="section level3">
<h3>¿Qué es <code>R</code>?</h3>
<p><code>R</code> es un lenguaje de programación para entorno estadístico y gráficos. La base del proyecto se encuentra en la siguiente dirección:</p>
<p><a href="http://www.r-project.org/" class="uri">http://www.r-project.org/</a></p>
<p>En esta dirección podremos descargar la última versión del programa así como acceder a toda la documentación, paquetes y librerías anexas, foros y otros proyectos relacionados.</p>
<p>Se trata de un proyecto de software libre, resultado de la implementación GNU del premiado lenguaje S. <code>R</code> y S-Plus -versión comercial de S- son, probablemente, los dos lenguajes más utilizados en investigación por la comunidad estadística, siendo además muy populares en el campo de la investigación biomédica, la bioinformática y las matemáticas financieras. <code>R</code> se distribuye bajo la licencia GNU GPL y está disponible para los sistemas operativos Windows, Macintosh, Unix y GNU/Linux.</p>
</div>
<div id="cran" class="section level3">
<h3>CRAN</h3>
<p>El mantenimiento del Proyecto <code>R</code> se realiza a traves del CRAN <em>The Comprehensive R Archive Network</em> donde se encuentran las últimas versiones del programa <code>R</code> y los paquetes anexos. Esta información se almacena en los Mirror<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Estas réplicas u espejos se suelen crear para facilitar grandes descargas y facilitar el acceso a la información aun cuando haya fallos en el servicio del servidor principal. El listado oficial puede consultarse aquí <a href="https://cran.r-project.org/mirrors.html">CRAN mirrors</a>.</p>
</div>
<div id="propiedades" class="section level3">
<h3>Propiedades</h3>
<ul>
<li><p>La capacidad de combinar, sin fisuras, análisis <em>preempaquetados</em> con análisis ad-hoc, específicos para una situación: capacidad de manipular y modificar datos y funciones.</p></li>
<li><p>Los gráficos de alta calidad: visualización de datos y producción de gráficos para artículos.</p></li>
<li><p>La comunidad de <code>R</code> es muy dinámica, con gran crecimiento del número de paquetes, e integrada por estadísticos de gran renombre (ej., J. Chambers, L. Terney, B. Ripley, D. Bates, ).</p></li>
<li><p>Hay extensiones específicas a nuevas áreas como bioinformática, geoestadística y modelos gráficos.</p></li>
<li><p>Es un lenguaje orientado a objetos.</p></li>
</ul>
</div>
<div id="instalacion" class="section level3">
<h3>Instalación</h3>
<p>Depende del sistema operativo, pero todo se puede encontrar en</p>
<p><a href="http://cran.es.r-project.org/bin" class="uri">http://cran.es.r-project.org/bin</a></p>
<p>Para Windows se puede obtener un ejecutable desde</p>
<p><a href="http://cran.es.r-project.org/bin/windows/base" class="uri">http://cran.es.r-project.org/bin/windows/base</a></p>
<p>Al ejecutar el archivo se instalará el sistema base y los paquetes recomendados.</p>
</div>
<div id="paquetes" class="section level3">
<h3>Paquetes</h3>
<p><code>R</code> consta de un sistema base y de paquetes adicionales que extienden su funcionalidad. Podemos encontrarlos en</p>
<p><a href="http://cran.es.r-project.org/src/contrib/PACKAGES.html" class="uri">http://cran.es.r-project.org/src/contrib/PACKAGES.html</a></p>
<p>Tipos de paquetes:</p>
<ul>
<li><p>Los que forman parte del sistema <em>base</em>: <em>ctest</em>, <em>graphics</em>, … .</p></li>
<li><p>Los que no son parte del sistema base, pero son <em>recommended</em>: <em>xlsx</em>, <em>survival</em>, <em>nlme</em>, … .</p></li>
<li><p>Otros paquetes (<em>UsingR</em>, <em>foreing</em>, … ). éstos se han de seleccionar e instalar individualmente.</p></li>
</ul>
</div>
<div id="documentacion" class="section level3">
<h3>Documentación</h3>
<p>Los <a href="https://cran.r-project.org/manuals.html">manuales</a> de <code>R</code>, incluidos en toda instalación.</p>
<ul>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html">An introduction to R</a> is based on the former “Notes on R”“, gives an introduction to the language and how to use <code>R</code> for doing statistical analysis and graphics.</p></li>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-data.html">R Data Import/Export</a> describes the import and export facilities available either in <code>R</code> itself or via packages which are available from CRAN.</p></li>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html">R Installation and Administration</a>.</p></li>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html">Writing R Extensions</a> covers how to create your own packages, write <code>R</code> help files, and the foreign language (C, C++, Fortran, …) interfaces.</p></li>
<li><p>A draft of <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html">The R language definition</a> documents the language per se. That is, the objects that it works on, and the details of the expression evaluation process, which are useful to know when programming <code>R</code> functions.</p></li>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-ints.html">R Internals</a>: a guide to the internal structures of R and coding standards for the core team working on <code>R</code> itself.</p></li>
</ul>
</div>
</div>
<div id="primeros-pasos-en-r" class="section level2">
<h2>Primeros pasos en <code>R</code></h2>
<div id="inicio" class="section level3">
<h3>Inicio</h3>
<p>Iniciar una sesión de <code>R</code></p>
<ul>
<li><p>Hacer doble-click en el icono. Se abrirá <em>Rgui.exe</em>.</p></li>
<li><p>Desde una ventana del sistema ejecutar <em>Rterm.exe</em>. Parecido a <code>R</code> en Unix o Linux.</p></li>
</ul>
</div>
<div id="guis-de-r" class="section level3">
<h3>GUI’s de <code>R</code></h3>
<p>El programa <code>R</code> viene con una GUI<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> que facilita la interacción entre el usuario y el programa. Hay otros proyectos abiertos que proporcionan otras GUI para <code>R</code>:</p>
<ul>
<li><p><a href="https://www.rstudio.com/">RStudio</a>, Es una interfaz gráfica multiplataforma con un entorno de trabajo muy completo.</p></li>
<li><p><a href="http://rcommander.com/">R Commander (Rcmdr)</a>, una interfaz gráfica multiplataforma basada en tcltk.</p></li>
<li><p><a href="https://rkward.kde.org/">RKWard</a>, basado en <em>KDE</em>.</p></li>
<li><p><a href="https://www.rforge.net/JGR/">JGR</a> o <a href="https://www.rforge.net/JGR/">Java GUI for R</a>, Una terminal de <code>R</code> multiplataforma basada en Java.</p></li>
<li><p><a href="http://rcom.univie.ac.at/">RExcel</a>, que permite usar <code>R</code> y <em>Rcmdr</em> desde Microsoft Excel.</p></li>
<li><p><a href="http://www.ggobi.org/rggobi/">rggobi</a>, Una interfaz a <em>GGobi</em> para visualización.</p></li>
</ul>
</div>
<div id="primera-sesion" class="section level3">
<h3>Primera sesión</h3>
<pre class="r"><code>2 + 2
## [1] 4
sqrt(10)
## [1] 3.162278
log(100, base = 10)
## [1] 2
2*3*4*5
## [1] 120
# Intereses sobre 1000 euros
1000*(1+0.075)^5 - 1000
## [1] 435.6293
# R conoce pi
pi
## [1] 3.141593
# Convertimos ángulos a radianes y luego calculamos el seno
sin(c(0,30,45,60,90)*pi/180)
## [1] 0.0000000 0.5000000 0.7071068 0.8660254 1.0000000</code></pre>
</div>
<div id="la-ayuda-en-r" class="section level3">
<h3>La ayuda en <code>R</code></h3>
<ul>
<li><p>?rnorm</p></li>
<li><p>help.start()</p></li>
<li><p>?help.search</p></li>
<li><p>help.search(“normal”“)</p></li>
<li><p>?apropos</p></li>
<li><p>apropos(“normal”“)</p></li>
<li><p>?demo</p></li>
<li><p>demo(graphics); demo(persp); demo(lm.glm)</p></li>
</ul>
</div>
<div id="instalar-paquetes-adicionales" class="section level3">
<h3>Instalar paquetes adicionales</h3>
<ul>
<li><p>Desde el menú <code>Packages -&gt; Install package(s)</code>.</p></li>
<li><p>Primero nos pide seleccionar el “CRAN mirror”, <a href="https://cran.r-project.org/mirrors.html">CRAN mirrors</a>.</p></li>
<li><p>Desde <code>R</code>, con <code>install.packages()</code>.</p></li>
<li><p>Desde una “ventana del sistema”.</p></li>
<li><p><code>Rcmd INSTALL paquete</code></p></li>
</ul>
</div>
<div id="un-editor-adeacuado" class="section level3">
<h3>Un editor adeacuado</h3>
<p>¿Por qué usar <code>R</code> desde un editor?</p>
<ul>
<li><p>El uso de scripts y el mantenimiento del código ordenado y comentado es una buena práctica estadística.</p></li>
<li><p>Colores de sintaxis, completa paréntesis, …</p></li>
<li><p>Una interface común para otros paquetes estadísticos: <em>SAS</em>, <em>XLispStat</em>, <em>Arc</em>, <em>Excel</em>, …, Numéricos: <em>Octave</em>, … o procesador de texto: <em>LaTeX</em>, … .</p></li>
</ul>
<p>Una buena elección: <a href="https://www.rstudio.com/">RStudio</a>.</p>
</div>
<div id="un-primer-ejemplo" class="section level3">
<h3>Un primer ejemplo</h3>
<p>Sea <span class="math inline">\(X\)</span> una variable aleatorio con distribucióon exponencial de parámetro <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(X_1, X_2, \ldots , X_n\)</span> una muestra aleatoria simple. Se sabe que la distribución de <span class="math inline">\(Z = n \cdot \min \left\{X_1, X_ 2, \ldots , X_n\right\}\)</span> es exponencial de parámetro <span class="math inline">\(\alpha\)</span>.</p>
<pre class="r"><code>alpha &lt;- 0.01
n &lt;- 50
m &lt;- 1000

datos &lt;- matrix(rexp(n * m, alpha), ncol=n)

fz &lt;- function(x) n*min(x)
z &lt;- apply(datos,1,fz)
mean(z)
## [1] 103.3159</code></pre>
<pre class="r"><code>hist(z, freq = FALSE)
points(dexp(0:600,alpha), type = &quot;l&quot;)</code></pre>
<p><img src="figuras/manual/primer_ejemplo_2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ks.test(z,&quot;pexp&quot;,alpha)
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  z
## D = 0.018244, p-value = 0.8933
## alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div id="objetos-de-r" class="section level2">
<h2>Objetos de <code>R</code></h2>
<p>Todo en <code>R</code> es un objeto, incluyendo funciones y estructuras de datos. Cada objeto tiene una estructura y características propias.</p>
<ul>
<li><p>Para saber los objetos que tenemos en el espacio de trabajo utilizaremos <code>ls()</code>.</p></li>
<li><p>Escribir el nombre de un objeto muestra su contenido.</p></li>
<li><p>Para guardar el contenido del espacio de trabajo se pueden utilizar las funciones <code>save.image()</code> y <code>save(&lt;objetos&gt;, file = &quot;nombre.RData&quot;)</code>.</p></li>
<li><p>Se puede acceder a objetos de la carpeta de trabajo o del camino que especifiquemos.</p></li>
</ul>
<div id="tipos-de-objeto" class="section level3">
<h3>Tipos de objeto</h3>
<ul>
<li>Objetos del lenguaje</li>
<li>Llamadas</li>
<li>Expresiones</li>
<li>Nombres</li>
<li>Expresiones</li>
<li>Funciones</li>
<li>Lista de argumentos</li>
<li>Código</li>
<li>Entorno</li>
<li>Sin objeto: <code>NULL</code></li>
</ul>
<div id="vector" class="section level4">
<h4>Vector</h4>
<p><strong>Vector</strong>: Colección ordenada de elementos del mismo tipo</p>
<pre class="r"><code>x &lt;- c(1, 2, 3)
x
## [1] 1 2 3
y &lt;- c(FALSE, TRUE, TRUE)
y
## [1] FALSE  TRUE  TRUE
z &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)
z
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
</div>
<div id="array" class="section level4">
<h4>Array</h4>
<p><strong>Array</strong>: Generalización multidimensional del vector. Elementos del mismo tipo.</p>
<pre class="r"><code>mat &lt;- matrix(rnorm(9), ncol = 3)
mat
##            [,1]       [,2]       [,3]
## [1,]  0.5751449  0.3604237 -0.7847047
## [2,]  0.2496536 -0.3901235 -0.3462017
## [3,] -0.5250231  0.9032771  0.6694679</code></pre>
</div>
<div id="data-frame" class="section level4">
<h4>Data frame</h4>
<p><strong>Data Frame</strong>: Como el array, pero con columnas de diferentes tipos. Es el objeto más habitual para los datos experimentales.</p>
<pre class="r"><code>ejemplo &lt;- data.frame(
  ID = c(&quot;gen0&quot;, &quot;genB&quot;, &quot;genZ&quot;),
  subj1 = c(10, 25, 33), 
  subj2 = c(NA, 34, 15),
  oncogen = c(TRUE, TRUE, FALSE),
  loc = c(1,30, 125))
ejemplo
##     ID subj1 subj2 oncogen loc
## 1 gen0    10    NA    TRUE   1
## 2 genB    25    34    TRUE  30
## 3 genZ    33    15   FALSE 125</code></pre>
</div>
<div id="factor" class="section level4">
<h4>Factor</h4>
<p><strong>Factor</strong>: Tipo de vector para datos cualitativos.</p>
<pre class="r"><code>x &lt;- c(1, 2, 2, 1, 1, 2, 1, 2, 1)
x
## [1] 1 2 2 1 1 2 1 2 1
x &lt;- factor(c(1, 2, 2, 1, 1, 2, 1, 2, 1))
x
## [1] 1 2 2 1 1 2 1 2 1
## Levels: 1 2</code></pre>
</div>
<div id="lista" class="section level4">
<h4>Lista</h4>
<p><strong>Lista</strong>: vector generalizado. Cada lista está formada por componentes que pueden ser de distinto tipo. Son contenedores generales de datos. Muy flexibles, pero sin estructura. Muchas funciones devuelven una lista o conjunto de resultados de distinta longitud y distinto tipo.</p>
<pre class="r"><code>una.lista &lt;- list(vec = rnorm(5),
                  mat = matrix(rnorm(4), ncol = 2))
una.lista
## $vec
## [1]  0.3582110  0.4057689 -0.7367596  1.7724745  0.3818547
## 
## $mat
##            [,1]       [,2]
## [1,] -0.1319224 -0.2819397
## [2,] -1.6945726 -1.3825758</code></pre>
</div>
<div id="atributos" class="section level4">
<h4>Atributos</h4>
<ul>
<li><p><strong>Modo</strong>: Tipo básico en un vector o array: lógico, entero, real, carácter, … <code>mode</code></p></li>
<li><p><strong>Tipo</strong>: Tipo de los vectores o arrays: double, character, … <code>typeof</code></p></li>
<li><p><strong>Nombres</strong>: Etiquetas de los elementos individuales de un vector o lista: <code>names</code></p></li>
<li><p><strong>Dimensiones</strong>: Dimensiones de los arrays (alguna puede ser cero): <code>dim</code></p></li>
<li><p><strong>Dimnames</strong>: Nombres de las dimensiones de los arrays: <code>dimnames</code></p></li>
<li><p><strong>Clase</strong>: Vector alfanumérico con la lista de las clases del objeto: <code>class</code></p></li>
<li><p><strong>Otros</strong>: Atributos de una serie temporal.</p></li>
</ul>
<pre class="r"><code>x &lt;- 1:15; length(x)
## [1] 15
y &lt;- matrix(5, nrow = 3, ncol = 4)
dim(y)
## [1] 3 4
is.vector(x)
## [1] TRUE
is.vector(y)
## [1] FALSE

x1 &lt;- 1:5
x2 &lt;- c(1, 2, 3, 4, 5)
x3 &lt;- &quot;patata&quot;
x4 &lt;- TRUE
typeof(x1)
## [1] &quot;integer&quot;
typeof(x2)
## [1] &quot;double&quot;
typeof(x3)
## [1] &quot;character&quot;
typeof(x4)
## [1] &quot;logical&quot;

w &lt;- data.frame(
  Suj = c(&quot;Suj 1&quot;, &quot;Suj 2&quot;, &quot;Suj 3&quot;),
  Pes = c(56.1, 73.6, 81.2),
  Alt = c(145, 165, 172))
attributes(w)  
## $names
## [1] &quot;Suj&quot; &quot;Pes&quot; &quot;Alt&quot;
## 
## $row.names
## [1] 1 2 3
## 
## $class
## [1] &quot;data.frame&quot;

f1 &lt;- function(x) {
  return(2 * x)
  }
attributes(f1)
## $srcref
## function(x) {
##   return(2 * x)
##   }
is.function(f1)
## [1] TRUE
f1(4)
## [1] 8</code></pre>
</div>
<div id="nombres" class="section level4">
<h4>Nombres</h4>
<ul>
<li><p>Los nombres válidos para un objeto son combinaciones de letras, números y el punto (“.”).</p></li>
<li><p>Los nombres no pueden empezar con un número.</p></li>
<li><p><code>R</code> es <em>case-sensitive</em>: x != X.</p></li>
<li><p>Hay nombres reservados: <em>function</em>, <em>if</em>, … .</p></li>
<li><p>Mejor evitar nombres que <code>R</code> usa: “c”.</p></li>
<li><p>Las asignaciones se hacen con <code>&lt;-</code> y se recomiendan los espacios. El signo <code>=</code> se reserva para los argumentos de las funciones.</p></li>
<li><p>La función <code>make.names()</code> convierte una cadena de texto en una cadena que pueda utilizarse como nombre de una variable en una matriz, data.frame, …</p></li>
</ul>
</div>
<div id="operadores-aritmeticos" class="section level4">
<h4>Operadores aritméticos</h4>
<ul>
<li><p>Suma <code>+</code>, resta <code>-</code>, multiplicación <code>*</code>, división <code>/</code>.</p></li>
<li><p>Potencia <code>^</code>, raíz cuadrada <code>sqrt()</code>.</p></li>
<li><p>División entera <code>%/%, módulo: resto de la división entera</code>%%`.</p></li>
<li><p>Logaritmos <code>log()</code>, <code>log10()</code>, <code>log2()</code>, <code>logb(x, base)</code>, exponencial <code>exp()</code>.</p></li>
<li><p>Trigonométricas <code>sin()</code>, <code>cos()</code>, <code>tan()</code>, <code>asin()</code>, <code>acos()</code>, <code>atan()</code>.</p></li>
<li><p>Otras <code>max()</code>, <code>min()</code>, <code>range()</code>, <code>pmax()</code>, <code>pmin()</code>, <code>mean()</code>, <code>median()</code>, <code>var()</code>, <code>sd()</code>, <code>quantile()</code>, <code>sum()</code>, <code>prod()</code>, <code>diff()</code>, <code>cumsum()</code>, <code>cumprod()</code>, <code>cummax()</code>, <code>cummin()</code>.</p></li>
</ul>
</div>
</div>
</div>
<div id="graficos-en-r" class="section level2">
<h2>Gráficos en <code>R</code></h2>
<ul>
<li><p><code>R</code> incluye muchas y variadas funciones para hacer gráficos.</p></li>
<li><p>El sistema permite desde gráficos muy simples a figuras de calidad para incluir en artículos y libros.</p></li>
<li><p>También podemos ver un buen conjunto de ejemplos con <code>demo(graphics)</code>.</p></li>
<li><p>El comando <code>plot()</code> es uno de los más utilizados para realizar gráficos.</p></li>
<li><p>Si escribimos <code>plot</code>(<span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>) donde <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> son vectores con <span class="math inline">\(n\)</span> coordenadas, entonces <code>R</code> representa el gráfico de dispersión con los puntos de coordenadas (<span class="math inline">\(x_i\)</span>, <span class="math inline">\(y_i\)</span>).</p></li>
</ul>
<p>El principal comando para generar un gráfico en <code>R</code> es <code>plot()</code>. Si generamos un vector aleatorio de dimensión 10. Uno de los argumentos más útiles es <code>type</code> cuyos parámetros pueden ser: <code>p</code> para puntos, <code>l</code> para líneas, … (?plot). Para representarlo gráficamente sólo tenemos que escribir:</p>
<pre class="r"><code>x &lt;- rnorm(10)
par(mfrow = c(2,3), mar = c(3.1, 3.1, 2.1, 0.5))
plot(x, type = &quot;p&quot;, main = &quot;type = p&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
plot(x, type = &quot;l&quot;, main = &quot;type = l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
plot(x, type = &quot;b&quot;, main = &quot;type = b&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
plot(x, type = &quot;c&quot;, main = &quot;type = c&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
plot(x, type = &quot;o&quot;, main = &quot;type = o&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
plot(x, type = &quot;h&quot;, main = &quot;type = h&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_plot_type-1.png" alt="Representación de los mismos datos con la función *plot()* considerando diferentes argumentos para *type.*" width="672" />
<p class="caption">
Representación de los mismos datos con la función <em>plot()</em> considerando diferentes argumentos para <em>type.</em>
</p>
</div>
<p>Podemos modificar ciertos atributos del gráfico, por ejemplo el color de la línea (<code>col</code>) y el tamaño de la línea (<code>lwd</code>). <code>R</code> entiende como argumentos los nombres de los colores: <code>red</code>, <code>green</code>, <code>blue,</code>… Podemos ver los colores predefinidos con la función <code>colours()</code>.</p>
<pre class="r"><code>plot(x, 
     col = &quot;red&quot;, 
     type = &quot;l&quot;, 
     lwd = 5)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_plot_col-1.png" alt="Uso de diferentes argumentos de la función *plot()*" width="576" />
<p class="caption">
Uso de diferentes argumentos de la función <em>plot()</em>
</p>
</div>
<p>Podemos modificar los atributos de los límites del gráfico (<code>xlim</code>, <code>ylim</code>), las etiquetas de los ejes (<code>xlab</code>, <code>ylab</code>) y añadir un título (<code>main</code>).</p>
<pre class="r"><code>plot(x,
     col = &quot;red&quot;,
     type = &quot;l&quot;,
     lwd = 5,
     ylim = c(-4, 4),
     xlab = &quot;Eje X&quot;,
     ylab = &quot;Eje Y&quot;,
     main = &quot;Nuestra primera gráfica en R&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_plot_argumentos-1.png" alt="Uso de diferentes argumentos de la función *plot()*" width="576" />
<p class="caption">
Uso de diferentes argumentos de la función <em>plot()</em>
</p>
</div>
<div id="lineas-y-puntos" class="section level3">
<h3>Líneas y puntos</h3>
<p>Sobre un gráfico creado podemos añadir información secundaria en forma de líneas (<code>lines()</code>, <code>abline()</code>) y puntos (<code>points()</code>).</p>
<pre class="r"><code>
plot(x,
     col = &quot;red&quot;,
     type = &quot;l&quot;,
     lwd = 5,
     ylim = c(-4,4),
     xlab = &quot;Eje X&quot;,
     ylab = &quot;Eje Y&quot;,
     main = &quot;Nuestra primera gráfica en R&quot;)

points(x,
       col = &quot;blue&quot;,
       cex = 3,
       pch = 21,
       bg = &quot;green&quot;,
       lwd = 3)

abline(lm(x~seq(1,10)), 
       lty = 3, 
       lwd = 5, 
       col = &quot;orange&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_plot_lines_points-1.png" alt="Uso de diferentes argumentos de la función *plot()*" width="576" />
<p class="caption">
Uso de diferentes argumentos de la función <em>plot()</em>
</p>
</div>
</div>
<div id="texto" class="section level3">
<h3>Texto</h3>
<p>Otra opción interesante es la de introducir texto en nuestras figuras, para ello utilizaremos el comando <code>text()</code> que permite añadir texto en cualquier zona del gráfico.</p>
<pre class="r"><code>
plot(x,
     col = &quot;red&quot;,
     type = &quot;l&quot;,
     lwd = 5,
     ylim = c(-4, 4),
     xlab = &quot;Eje X&quot;,
     ylab = &quot;Eje Y&quot;,
     main = &quot;Nuestra primera gráfica en R&quot;)

points(x,
       col = &quot;red&quot;,
       cex = 3,
       pch = 21,
       bg = &quot;red&quot;)

text(x,
     label = format(x, 
                    digits = 2, 
                    nsmall = 2),
     cex = 1,
     font = 2)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_plot_text-1.png" alt="Uso de diferentes argumentos de la función *plot()*" width="576" />
<p class="caption">
Uso de diferentes argumentos de la función <em>plot()</em>
</p>
</div>
</div>
<div id="otros-comandos" class="section level3">
<h3>Otros comandos</h3>
<p>El comando <code>plot()</code> no es el único que existe para generar figurar, hay otros como: <code>boxplot()</code>, <code>barplot()</code>, <code>cdplot()</code>, <code>pie()</code>, …</p>
<pre class="r"><code>par(mfrow = c(2, 2))
boxplot(InsectSprays$count ~ InsectSprays$spray, 
        col = &quot;red&quot;)

barplot(tapply(InsectSprays$count, 
               INDEX = InsectSprays$spray, 
               FUN = &quot;mean&quot;))

pie(table(InsectSprays$spray),
    col = rainbow(6))

barplot(tapply(InsectSprays$count,
               INDEX = InsectSprays$spray,
               FUN = &quot;mean&quot;),
        horiz = TRUE,
        col = &quot;orange&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_plot_commands-1.png" alt="Uso de diferentes argumentos de la función *plot()*" width="672" />
<p class="caption">
Uso de diferentes argumentos de la función <em>plot()</em>
</p>
</div>
<p>Podemos modificar márgenes exteriores de figuras y entre figuras (ver <code>?par</code>, opciones: <code>oma</code>, <code>omi</code>, <code>mar</code>, <code>mai</code>, …).</p>
<ul>
<li><p>También gráficos 3D: <code>persp()</code>, <code>image()</code>, <code>contour()</code>, …</p></li>
<li><p>Histogramas: <code>hist()</code></p></li>
<li><p>Gráficos de barras: <code>barplot()</code></p></li>
<li><p>Gráficos de comparación de cuantiles, usados para comparar la distribución de dos variables, o la disribución de unos datos frente a un estándar: <code>qqplot()</code>, <code>qqnorm()</code> y en el paquete <code>car</code>, <code>qq.plot()</code>.</p></li>
<li><p>Notación matemática (<code>plotmath()</code>) y expresiones de texto arbitrariamente complejas.</p></li>
</ul>
</div>
</div>
<div id="programacion-en-r" class="section level2">
<h2>Programación en <code>R</code></h2>
<ul>
<li>Principales instrucciones</li>
<li>if(cond) expr</li>
<li>if(cond) cons.expr else alt.expr</li>
<li>for(var in seq) expr</li>
<li>while(cond) expr</li>
<li>switch</li>
<li>repeat expr</li>
<li>break</li>
<li>next</li>
</ul>
<p>La expresión <code>exp</code>} (también <code>alt.expr</code>) puede ser una expresión simple o compuestas.</p>
<p>Uno de los errores más habituales es el olvido de los corchetes, llaves, … alrededor de las instrucciones, i.e. después de <code>if(...)}</code> o <code>for(...)</code>.</p>
<div id="comando-if" class="section level3">
<h3>Comando if</h3>
<p><em>IF</em> significa <em>SI</em> (condicional). Su funcionamiento es simple, se evalúa una condición, si es verdadera ejecuta un código, si es falsa, ejecuta otro código (o continúa con la ejecución del programa).</p>
<pre class="r"><code>
f4 &lt;- function(x) {
  if(x &gt; 5) print(&quot;x &gt; 5&quot;)
  else {
  y &lt;- runif(1)
  print(paste(&quot;y es &quot;, y))
  }
}
f4(3)
## [1] &quot;y es  0.204685921780765&quot;</code></pre>
</div>
<div id="comando-ifelse" class="section level3">
<h3>Comando ifelse</h3>
<p><code>ifelse</code> es una versión vectorizada del comando <code>if</code>.</p>
<pre class="r"><code>x &lt;- c(4, 6, 7, 3, 1, 3)
ifelse(x&gt;5, x/2, x*2)
## [1] 8.0 3.0 3.5 6.0 2.0 6.0</code></pre>
</div>
<div id="comando-for" class="section level3">
<h3>Comando for</h3>
<p>Una de las estructuras de repetición empleada en la programación de algoritmos para repetir un código (una o más sentencias de programación) dependiendo de un contador.</p>
<pre class="r"><code>for(i in 1:5) {
  cat(&quot;el valor de i es&quot;, i, &quot;\n&quot;)
}
## el valor de i es 1 
## el valor de i es 2 
## el valor de i es 3 
## el valor de i es 4 
## el valor de i es 5</code></pre>
<p>la instrucción <code>break</code> permite salir del bucle.</p>
</div>
<div id="comando-while" class="section level3">
<h3>Comando while</h3>
<p>Existen otras estructuras de repetición que no dependen de un contador y si dependen de una condición.</p>
<pre class="r"><code>x &lt;- 2
while(x &lt; 100) {
  x &lt;- x^2
  print(x)
}
## [1] 4
## [1] 16
## [1] 256</code></pre>
<p>Cuando el valor de <span class="math inline">\(x\)</span> es sido mayor o igual que 100, sale del bucle.</p>
</div>
<div id="comando-switch" class="section level3">
<h3>Comando switch</h3>
<p>Podemos utilizar estructuras condicionales para ejecutar acciones. la función <code>switch()</code> nos permite utilizar estas opciones</p>
<pre class="r"><code>
cadena &lt;- &quot;R-project&quot;

switch(&quot;my&quot;,
    my = toupper(cadena),
    mn = tolower(cadena),
    ig = cadena)
## [1] &quot;R-PROJECT&quot;

switch(&quot;mn&quot;,
    my = toupper(cadena),
    mn = tolower(cadena),
    ig = cadena)
## [1] &quot;r-project&quot;</code></pre>
<p>Según el primer parámetro, se ejecuta una acción u otra.</p>
</div>
</div>
<div id="importar-datos-con-r" class="section level2">
<h2>Importar datos con <code>R</code></h2>
<p>Si vamos a trabajar con un conjunto de datos grande, es evidente, que no los vamos a introducir <em>uno a uno</em>. <code>R</code> tiene varias funciones incorporadas para facilitar esta tarea y pude importar datos desde una gran variedad de formatos (*.csv, *.xls, *.xlsx, *.sav, *.txt, …). Vamos a centrarnos en las principales funciones:</p>
<ul>
<li><p><code>read.table()</code>.</p></li>
<li><p><code>read.csv()</code>, <code>read.csv2()</code>.</p></li>
<li><p><code>read.xls()</code>,</p></li>
</ul>
<p>La función <code>read.xlx()</code> requiere al librería <code>xlsx</code>.</p>
<div id="read.table" class="section level3">
<h3>read.table()</h3>
<p>Con la función <code>read.table()</code> podemos importar directamente un <code>data.frame</code>. La sintaxis completa de la función es:</p>
<pre class="r"><code>read.table (fichero, header = TRUE, sep = &quot; &quot;, ...)</code></pre>
<p>Donde <code>fichero</code> es el nombre del fichero que queremos leer, <code>header</code> indica si nuestro fichero tiene los nombres de las variables en el encabezado y <code>sep</code> indica la separación existente entre las variables (&quot; &quot; indica un espacio en blanco, <span class="math inline">\(\backslash\)</span>t indica un tabulador, “;” indica punto y coma, …).</p>
<p>Hablamos de <code>read.csv()</code> y <code>read.csv2()</code>para leer ficheros con extensión *.csv<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> son un tipo de documento en formato abierto sencillo para representar datos en forma de tabla, en las que las columnas se separan por comas}. En muchos países europeos, el estándar es utilizar la “,” (coma) como separador de los decimales y el “;” (punto y coma) como separador de las variables. Si nuestro fichero sigue este estándar, podemos utilizar la función <code>read.csv2()</code> que tiene estos argumentos por defecto.</p>
</div>
</div>
</div>
<div id="graficos-en-r-1" class="section level1">
<h1>Gráficos en <code>R</code></h1>
<p>Los gráficos es una característica importante y extremadamente versatil de <code>R</code>. Los comandos de dibujo se dividen en tres grupos básicos:</p>
<ul>
<li><p>Funciones de <strong>alto nivel</strong> para crear nuevos gráficos.</p></li>
<li><p>Funciones de <strong>bajo nivel</strong> que añaden información a gráficos ya existentes en formas de puntos, líneas, y etiquetas</p></li>
<li><p>Funciones <strong>interactivas</strong> que permiten añadir o extraer información de un gráfico ya creado (<code>locator()</code>)</p></li>
</ul>
<p>Además, <code>R</code> permite exportar y salvar estos gráficos en múltiples formatos: *.ps, *.eps, *.jpg, *.pdf, *.png, … .</p>
<div id="alto-nivel" class="section level2">
<h2>Alto nivel</h2>
<p>En la creación de gráficos en <code>R</code> hay que considerar un nuevo concepto, el de <code>device driver</code>. Cuando creamos un gráfico, asociado a ese gráfico se encuentra el dispositivo gráfico, que puede ser una ventana donde se represente dicho gráfico.</p>
<p>Funciones como <code>dev.new()</code>, <code>dev.off()</code>, <code>dev.size()</code>, … permiten trabajar con estos dispositivos cuando trabajamos con funciones de bajo nivel. Las funciones de alto nivel nos abren y cierran estos dispositivos automáticamente.</p>
<p>Se puede modificar absolutamente <strong>todas las características</strong> de un entorno gráfico, otra cosa es que sea fácil. La función <code>plot()</code> es la más usada para generar gráficos. La función <code>plot()</code> tiene muchos argumentos que podemos modificar para obtener diferentes figuras. Además, el tipo de gráfico depende del tipo o de la clase del primer argumento.</p>
<pre class="r"><code>par(mfrow = c(2, 3))
plot(rnorm(10), 
     col = &quot;red&quot;,
     type = &quot;l&quot;,
     main = &quot;Figura 1&quot;)
plot(rnorm(10),
     col = &quot;blue&quot;,
     type = &quot;l&quot;,
     main = &quot;Figura 2&quot;,
     lwd = 3)
plot(rnorm(10),
     col = &quot;green&quot;,
     type = &quot;l&quot;,
     main = &quot;Figura 3&quot;,
     lwd = 5,
     lty = 3)
plot(rnorm(10),
     col = &quot;blue&quot;,
     type = &quot;h&quot;,
     main = &quot;Figura 4&quot;,
     xlab = &quot;Eje X&quot;,
     ylab = &quot;Eje Y&quot;)
plot(rnorm(10),
     col = &quot;yellow&quot;,
     type = &quot;o&quot;,
     main = &quot;Figura 5&quot;,
     sub = &quot;Color yellow&quot;,
     lwd = 3)
plot(rnorm(10),
     col = &quot;grey21&quot;,
     type = &quot;S&quot;,
     main = &quot;Figura 6&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_alto_nivel_1-1.png" alt="Representación de datos con la función *plot()* considerando diferentes argumentos para *type*, *main*, *col*, *xlab*, *ylab*." width="672" />
<p class="caption">
Representación de datos con la función <em>plot()</em> considerando diferentes argumentos para <em>type</em>, <em>main</em>, <em>col</em>, <em>xlab</em>, <em>ylab</em>.
</p>
</div>
<pre class="r"><code>par(mfrow = c(2, 3))
qqnorm(rnorm(100),
       main = &quot;qqnorm&quot;)
hist(rnorm(100),
     main = &quot;hist&quot;)
dotchart(rnorm(10),
         main = &quot;dotchart&quot;)
image(matrix(rnorm(100),
             ncol = 10),
      main = &quot;image&quot;)
contour(matrix(rnorm(100),
               ncol = 10),
        main = &quot;contour&quot;)
persp(matrix(rnorm(100),
             ncol = 10),
      main = &quot;persp&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_alto_nivel_2-1.png" alt="Representación de datos con distintas funciones de alto nivel." width="672" />
<p class="caption">
Representación de datos con distintas funciones de alto nivel.
</p>
</div>
</div>
<div id="bajo-nivel" class="section level2">
<h2>Bajo nivel</h2>
<p>Cuando se ha creado un gráfico, podemos modificarlo con gráficos de bajo nivel, es decir, puntos, líneas, leyendas, texto, polígonos, …</p>
<p>Estos comandos actuarán sobre el <code>device driver</code> actual, por ello debemos tener cuidado a la hora de utilizarlos, o generar un único gráfico cada vez.</p>
<p>Generamos un gráfico y vamos a ir realizándo diferentes modificaciones que cambien su aspecto.</p>
<pre class="r"><code>plot(rnorm(10),
     xlab = &quot;Eje X&quot;,
     ylab = &quot;Eje Y&quot;,
     main = &quot;Gráficos de bajo nivel&quot;,
     type = &quot;b&quot;,
     lwd = 3,
     col = &quot;gold&quot;)
points(x = c(1, 3, 5),
       y = c(0, -1, 1),
       pch = 23,
       col = &quot;blue&quot;,
       bg = &quot;blue&quot;,
       cex = 1.3)
lines(rnorm(10),
      lwd = 2,
      lty = 3,
      col = &quot;green&quot;)
abline(h = seq(-2, 2, length = 10),
       col = grey(0.2),
       lty = 2)
abline(v = seq(1, 10),
       col = grey(0.8),
       lty = 3)
polygon(x = c(3, 5, 9, 8, 4, 1),
        y = c(-0.8, -0.4, 0.0, 0.2, 0.3, -0.2),
        col = rgb(23, 46, 128, maxColorValue = 255),
        border = NA)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_bajo_nivel_1-1.png" alt="Representación de datos con distintas funciones de alto nivel." width="576" />
<p class="caption">
Representación de datos con distintas funciones de alto nivel.
</p>
</div>
<p>Y si no tenemos buen gusto podemos llegar a cometer verdaderas atrocidades …</p>
<pre class="r"><code>par(bg = &quot;grey60&quot;, lwd = 3, col = &quot;white&quot;)
valores &lt;- rnorm(10)

plot(valores,
     type = &quot;p&quot;,
     xlab = &quot;Eje X&quot;, 
     ylab = &quot;Eje Y&quot;,
     main = &quot;Título de la figura&quot;,
     sub = &quot;Subtítulo de la figura&quot;,
     xaxt = &quot;n&quot;,
     yaxt = &quot;n&quot;,
     col.main = &quot;gold&quot;,
     col.sub = &quot;yellow&quot;,
     col.lab = &quot;blue&quot;)

axis(side = 1, 
     at = 1:10,
     label = 1:10,
     cex.axis = 0.8,
     las = 1,
     col = &quot;white&quot;,
     lwd = 3,
     col.ticks = &quot;brown&quot;,
     col.axis = &quot;red&quot;,
     cex.axis = 1.2)

axis(side = 2,
     at = seq(-3, 3, by = 0.5),
     label = seq(-3, 3, by = 0.5),
     cex.axis = 1.2,
     las = 2,
     col = &quot;white&quot;,
     lwd = 3,
     col.ticks = &quot;orange&quot;,
     col.axis = &quot;violet&quot;)

points(valores,
       pch = 3,
       cex = 3,
       col = &quot;green&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ejemplos_bajo_nivel_2-1.png" alt="La representación de los datos no debe estar reñida con el buen gusto." width="576" />
<p class="caption">
La representación de los datos no debe estar reñida con el buen gusto.
</p>
</div>
</div>
<div id="interactivas" class="section level2">
<h2>Interactivas</h2>
<p>A diferencia de otros programas gráficos, cuando <code>R</code> presenta un gráfico, se puede seguir trabajando en el gráfico aún cuando ya haya sido presentado en pantalla. Hay funciones que permiten incluir información (texto, puntos, líneas, …) y funciones que permite extraer información:</p>
<ul>
<li><p><code>locator()</code>: Lee la posición del cursor en el gráfico cuando el primer botón del ratón es pulsado.</p></li>
<li><p><code>identify()</code>: Lee la posición del cursor en el gráfico cuando el primer botón del ratón es pulsado. Busca entonces las coordenadas en <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> para el punto más cercano al cursor. Si este punto está lo suficientemente cerca del cursor, su índice se obtiene como parte del valor de la llamada a la función.</p></li>
</ul>
</div>
<div id="dispositivos" class="section level2">
<h2>Dispositivos</h2>
<p>Ya hemos comentado que para <code>R</code> cada gráfico es independiente en cada dispositivo. Veamos con un ejemplo como trabaja. Si ejecutamos</p>
<pre class="r"><code>plot(rnorm(10))
plot(rnorm(100))</code></pre>
<p>Generará dos figuras, pero la segunda la superpondrá sobre la primera. Estos es debido a que ha utilizado el mismo dipositivo para los dos gráficos. De hecho, como título de la ventana donde se encuentra el gráfico tendremos <code>R Graphics: Device 2 (ACTIVE)</code>.</p>
<p>Ahora ejecutamos el siguiente código en <code>R</code></p>
<pre class="r"><code>x11()
plot(rnorm(10))
x11()
plot(rnorm(100))</code></pre>
<p>Generará dos figuras, cada una en su ventana ya que con el comando <code>x11()</code> (en Windows) abrimos un nuevo dispositivo. Ahora bien, la ventana que tiene el primer gráfico tiene como título <code>R Graphics: Device 2 (inactive)</code> y la segunda <code>R Graphics: Device 3 (ACTIVE)</code>, es decir, todos los gráficos de bajo nivel que ejecutemos se realizarán en esta última ventana.</p>
<p>Con los comandos</p>
<pre class="r"><code>dev.list()
dev.cur()
</code></pre>
<p>Obtenemos una lista de los dispositivos gráficos abiertos y cuál es el dispotivo gráfico actual.</p>
</div>
<div id="guardar-figuras" class="section level2">
<h2>Guardar figuras</h2>
<p>Podemos salvar las figuras en múltiples formatos. El comando es el siguiente:</p>
<pre class="r"><code>savePlot(filename = &quot;filename&quot;,
         type = &quot;png&quot;,
         dev = dev.cur(),
         restoreConsole = TRUE)</code></pre>
<p>Con el argumento <code>type</code> seleccionamos el formato en el que vamos a guardar la figura: *.png, *.jpg, *.bmp, *.pdf, … Observamos que por defecto, se guarda el gráfico del dispositivo actual <code>current device, dev.cur()</code>. Si estuvieramos trabajando con varios gráficos, deberíamos especificar el dispositivo. Para finalizar, es conveniente cerrar el dispositivo gráfico guardado, podemos hacerlo ejecutando:</p>
<pre class="r"><code>dev.off(dev.cur())</code></pre>
</div>
</div>
<div id="programacion-en-r-1" class="section level1">
<h1>Programación en <code>R</code></h1>
<p>Ya tenemos una idea general de la funcionalidad de <code>R</code>, volvamos por un momento al uso de <code>R</code> como lenguaje de programación. Veremos diferentes ejemplos e intentaremos implementarlos en <code>R</code>.</p>
<div id="variables" class="section level2">
<h2>Variables</h2>
<p>Hay que considerar que cuando se programa en <code>R</code> podemos utilizar todos los objetos de <code>R</code>: Data frames, Listas, Arrays, Matrices, Vectores, … Además, cada objeto está compuesto de un tipo básico de elementos, que pueden ser:</p>
<ul>
<li>integer</li>
<li>double</li>
<li>character</li>
<li>logical: que puede tomar los valores <code>TRUE</code>, <code>FALSE</code> o <code>NA</code>.</li>
<li>factor o categorical</li>
</ul>
<p>En <code>R</code> no hace definir previamente las variables, únicamente se asigna el valor que queramos.</p>
<pre class="r"><code>a &lt;- 3
a
## [1] 3
v &lt;- c(TRUE, FALSE, TRUE)
v
## [1]  TRUE FALSE  TRUE
t &lt;- &quot;Una cadena de texto&quot;
t
## [1] &quot;Una cadena de texto&quot;</code></pre>
<p>Como hemos visto, el modo de asignación por defecto es <code>&lt;-</code>, aunque existe funciones que nos permiten un mayor control. Estas funciones son: <code>get()</code>, <code>mget()</code>, <code>assign()</code>, …</p>
<pre class="r"><code>assign(&quot;mivariable&quot;,3.141592)
mivariable
## [1] 3.141592
&quot;prueba&quot; &lt;- 10
&quot;prueba&quot;
## [1] &quot;prueba&quot;
get(&quot;prueba&quot;)
## [1] 10</code></pre>
</div>
<div id="bucles-y-vectorizacion" class="section level2">
<h2>Bucles y vectorización</h2>
<p>Una ventaja de <code>R</code> comparado con otros programas estadísticos con <em>menus y botones</em> es la posibilidad de programar de una manera muy sencilla una serie de análisis que se puedan ejecutar de manera sucesiva.</p>
<p>Esto es común a cualquier otro lenguaje de programación, pero <code>R</code> posee características muy particulares que hacen posible programar sin muchos conocimientos o experiencia previa en programación.</p>
<p>Como en otros lenguajes, <code>R</code> posee estructuras de control que no son muy diferentes a las de un lenguaje de alto nivel como C, C++, VB, FORTRAN, … Supongamos que tenemos un vector <span class="math inline">\(x\)</span>, y para cada elemento de <span class="math inline">\(x\)</span> con valor igual a <span class="math inline">\(b\)</span>, queremos asignar el valor 0 a otra variable <span class="math inline">\(y\)</span>, o sino asignarle <span class="math inline">\(1\)</span>. Primero creamos un vector <span class="math inline">\(y\)</span> de la misma longitud de <span class="math inline">\(x\)</span>:</p>
<pre class="r"><code>b &lt;- 3
x &lt;- sample(1:5, 5)
y &lt;- numeric(length(x))
for (i in 1:length(x)) {
  if (x[i] == b) {
    y[i] &lt;- 0 
  } else {
    y[i] &lt;- 1
  }
}
x
## [1] 5 3 1 2 4
y
## [1] 1 0 1 1 1</code></pre>
<p>También se pueden usar corchetes para ejecutar varias instrucciones:</p>
<pre class="r"><code>for (i in 1:length(x)) {
  y[i] &lt;- 1
}
if (x[i] == b) {
  y[i] &lt;- 0
}</code></pre>
<p>Sin embargo, este tipo de bucles y estructuras se pueden evitar gracias a una característica clave en <code>R</code>: vectorización. La vectorización hace los bucles implícitos en las expresiones. Por ejemplo, consideremos la suma de dos vectores:</p>
<pre class="r"><code>z &lt;- x + y
x
## [1] 5 3 1 2 4
y
## [1] 1 1 1 1 1
z
## [1] 6 4 2 3 5</code></pre>
<p>Esta suma se hubiera podido escribir como un bucle, como se hace en muchos otros lenguajes:</p>
<pre class="r"><code>z &lt;- numeric(length(x))
for (i in 1:length(z)) {
  z[i] &lt;- x[i] + y[i]
}
z
## [1] 6 4 2 3 5</code></pre>
<p>En este caso, es necesario crear con anterioridad el vector <span class="math inline">\(z\)</span> por la necesidad de indexar los elementos. Es fácil ver que este bucle explícito solo funciona si <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> son de la misma longitud.</p>
<p>Las ejecuciones condicionales (<code>if</code> … <code>else</code>) se pueden evitar con el uso de <em>indexación lógica</em>. Volviendo al ejemplo anterior:</p>
<pre class="r"><code>x == b
## [1] FALSE  TRUE FALSE FALSE FALSE
y[x == b] &lt;- 0
y[x != b] &lt;- 1</code></pre>
<div id="apply" class="section level3">
<h3>apply()</h3>
<p>También existen varias funciones del tipo <code>apply</code><a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> que evitan el uso de bucles.</p>
<p>La función <code>apply()</code> actúa sobre las filas o columnas de una matriz, y su sintaxis es <code>apply(X, MARGIN, FUN, ...)</code>, donde <code>X</code> es una matriz, <code>MARGIN</code> indica si se van a usar las filas (1), las columnas (2), o ambas (c(1, 2)), <code>FUN</code> es una función (o un operador, pero en este caso debe especificarse en corchetes) a ser aplicada.</p>
<pre class="r"><code>x &lt;- rnorm(10, -5, 0.1)
y &lt;- rnorm(10, 5, 2)
X &lt;- cbind(x, y)
apply(X, 2, mean)
##         x         y 
## -4.972464  4.477069</code></pre>
</div>
<div id="lapply" class="section level3">
<h3>lapply()</h3>
<p>La función <code>lapply()</code> actúa sobre una lista. Su sintaxis es similar a la de <code>apply()</code> y devuelve una lista.</p>
<pre class="r"><code>forms &lt;- list(y~x)
lapply(forms, lm)
## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)            x  
##     -11.503       -3.214</code></pre>
</div>
<div id="sapply" class="section level3">
<h3>sapply()</h3>
<p>La función <code>sapply()</code> es una variación más flexible de <code>lapply()</code> que puede tomar un vector o una matriz como argumento principal, y devuelve los resultados en una manera más amigable, generalmente en una tabla.</p>
</div>
</div>
<div id="programa-en-r" class="section level2">
<h2>Programa en <code>R</code></h2>
<p>Los programas en <code>R</code> se escriben en un archivo que se guarda en formato ASCII con terminación *.R. Un programa se usa cuando uno quiere hacer una o varias operaciones muchas veces. En nuestro primer ejemplo, queremos hacer el mismo aálisis de regresión para una serie de datos que están en tres archivos diferentes. Procederemos paso a paso y veremos diferentes maneras de programar este problema.</p>
<p>Primero, hagamos nuestro programa de la manera más intuitiva posible ejecutando sucesivamente los comandos necesarios, teniendo cuidado de particionar el dispositivo gráfico con anterioridad.</p>
<pre class="r"><code>layout(matrix(1:3, 1, 3))
data &lt;- read.table(&quot;data/setosa.dat&quot;,header=TRUE)
plot(data$Sepal.Length, data$Sepal.Width, type=&quot;p&quot;)
title(&quot;setosa&quot;)

data &lt;- read.table(&quot;data/versicolor.dat&quot;,header=TRUE)
plot(data$Sepal.Length, data$Sepal.Width, type=&quot;p&quot;)
title(&quot;versicolor&quot;)

data &lt;- read.table(&quot;data/virginica.dat&quot;,header=TRUE)
plot(data$Sepal.Length, data$Sepal.Width, type=&quot;p&quot;)
title(&quot;virginica&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/programa_1-1.png" alt="Resultados del programa." width="672" />
<p class="caption">
Resultados del programa.
</p>
</div>
<p>El problema del primer programa es que se puede volver bastante largo si queremos agregar otras especies. Más aún, algunos comandos se ejecutan varias veces, y por lo tanto, se pueden agrupar y ejecutar juntos cambiando algunos argumentos. La estrategia que usamos aqui es poner estos argumentos en vectores de tipo caracter, y después usar indexación para acceder a los diferentes valores.</p>
<pre class="r"><code>layout(matrix(1:3, 1, 3))
especie &lt;- c(&quot;setosa&quot;, &quot;versicolor&quot;, &quot;virginica&quot;)
fichero &lt;- c(&quot;data/setosa.dat&quot; , &quot;data/versicolor.dat&quot;, &quot;data/virginica.dat&quot;)
for(i in 1:length(especie)) {
  data &lt;- read.table(fichero[i],header=TRUE)
  plot(data$Sepal.Length, data$Sepal.Width, type=&quot;p&quot;)
  title(especie[i])
}</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/programa_2-1.png" alt="Resultados del programa." width="672" />
<p class="caption">
Resultados del programa.
</p>
</div>
<p>Observamos que el argumento <code>file[i]</code> no se pone entre comillas en <code>read.table()</code> ya que este argumento ya es de tipo caracter.</p>
<p>Ahora nuestro programa es mucho más compacto. Es más fácil agregar otras especies ya que los nombres de las mismas están en vectores al principio del programa.</p>
<p>Los programas anteriores funcionarán correctamente siempre y cuando los archivos de datos *.dat estén localizados en el directorio de trabajo especificado, de lo contrario el usuario debe cambiar el directorio de trabajo o especificar la dirección completa en el programa<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>.</p>
<p>Hemos visto que la mayor parte del trabajo en <code>R</code> se realiza a través de funciones con sus respectivos argumentos entre paréntesis. <code>R</code> nos permite escribir nuestras propias funciones lo que nos permite un uso flexible, eficiente y racional de <code>R</code>. Volvamos a nuestro ejemplo donde leemos unos datos y dibujamos una gráfica de los mismos. Si deseamos hacer esta operación en diferentes situaciones, puede ser una buena idea escribir una función:</p>
<pre class="r"><code>mifun &lt;- function(S, F)
{
  data &lt;- read.table(F, header = TRUE)
  plot(data$Sepal.Length, data$Sepal.Width, type = &quot;p&quot;)
  title(S)
}</code></pre>
<p>Para que esta función pueda ser ejecutada, primero es necesario cargarla en memoria, y esto se puede hacer de varias maneras. Las líneas de la función se pueden escribir directamente desde el teclado, como cualquier otro comando, o ser copiada y pegada a un editor de texto. Si la función está guardada en un archivo de texto, se puede cargar con <code>source()</code> como cualquier otro programa.</p>
<p>Una vez la función es cargada se puede ejecutar con un solo comando como por ejemplo, <code>mifun(&quot;setosa&quot;, &quot;data/setosa.dat&quot;)</code>. Por lo tanto, tenemos ahora una tercera versión de nuestro programa:</p>
<pre class="r"><code>layout(matrix(1:3, 1, 3))
mifun(&quot;setosa&quot;, &quot;data/setosa.dat&quot;)
mifun(&quot;versicolor&quot;, &quot;data/versicolor.dat&quot;)
mifun(&quot;virginica&quot;, &quot;data/virginica.dat&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/programa_3-1.png" alt="Resultados del programa." width="672" />
<p class="caption">
Resultados del programa.
</p>
</div>
</div>
<div id="funciones" class="section level2">
<h2>Funciones</h2>
<p>En <code>R</code>, no es necesario declarar las variables usadas dentro de la función (a diferencia de otros lenguajes como C o FORTRAN). Cuando una función es ejecutada, <code>R</code> utiliza una regla llamada <code>ámbito lexicográfico</code> para decidir si un objeto es local a una función o global. Vamos a entenderlo con el siguiente ejemplo</p>
<pre class="r"><code>foo &lt;- function() print(x)
x &lt;- 1
foo()
## [1] 1</code></pre>
<p>El nombre <span class="math inline">\(x\)</span> no está definido dentro de <code>foo()</code>, asi que <code>R</code> buscará <span class="math inline">\(x\)</span> dentro del ámbito circundante e imprimirá su valor. De lo contrario, se genera un mensaje de error y la ejecución se cancela.</p>
<p>Si <span class="math inline">\(x\)</span> es utilizado como el nombre de un objeto dentro de la función, el valor de <span class="math inline">\(x\)</span> en el ambiente global (externo a la función) no cambia.</p>
<pre class="r"><code>x &lt;- 1
foo2 &lt;- function() { x &lt;- 2; print(x) }
foo2()
## [1] 2
x
## [1] 1</code></pre>
<p>Esta vez <code>print()</code> usa el objeto <span class="math inline">\(x\)</span> definido dentro de su ambiente, es decir, el ambiente de <code>foo2</code>.</p>
<p>La palabra <em>circundante</em> utilizada arriba es importante. En nuestras dos funciones ejemplo existen dos ambientes: uno global y el otro local a cada una de las funciones <code>foo()</code> o <code>foo2()</code>. Si existen tres o más ambientes anidados, la búsqueda de objetos se hace progresivamente desde un ambiente dado al ambiente circundante a este, y asi sucesivamente hasta llegar el ambiente global.</p>
<p>Existen dos maneras de especificar argumentos a una función: por sus posiciones o por sus nombres, también llamados argumentos marcados. Por ejemplo, consideremos una función con tres argumentos:</p>
<pre class="r"><code>foo &lt;- function(arg1, arg2, arg3) {}
foo()</code></pre>
<p>Se puede ejecutar sin nombrar los argumentos <code>arg1</code>, <code>arg2</code>, <code>arg3</code>, si los objetos correspondientes están colocados en la posición correcta; por ejemplo: <code>foo(x, y, z)}</code> Sin embargo, la posición no tiene ninguna importancia si se utilizan los nombres de los argumentos, por ejemplo, <code>foo(arg3 = z, arg2 = y, arg1 = x)</code>.</p>
<p>Otro rasgo importante de las funciones en <code>R</code> es la posibilidad de usar valores por defecto en la definición. Por ejemplo:</p>
<pre class="r"><code>foo &lt;- function(arg1, arg2 = 5, arg3 = FALSE) {
}</code></pre>
<p>Ambos comandos <code>foo(x)</code> y <code>foo(x, 5, FALSE)</code> producirán exactamente el mismo resultado. El uso de valores por defecto en la definición de una función es bastante útil y permite una mayor flexibilidad.</p>
<p>Otro ejemplo de la flexibilidad de <code>R</code> se muestra con la siguiente función que simula el comportamiento de una población bajo el <a href="http://en.wikipedia.org/wiki/Ricker_model">Modelo de Ricker</a>:</p>
<span class="math display">\[\begin{equation}
N_{t+1} = N_{t} \exp^{ \left(r \left( 1 - \frac{N_{t}}{K}\right) \right)}
\end{equation}\]</span>
<p>Este modelo es usado ampliamente en ecología de poblaciones. El objetivo es simular el modelo con respecto a la tasa de crecimiento <span class="math inline">\(r\)</span> y el número inicial de individuos en la población <span class="math inline">\(N_{0}\)</span> (la capacidad de carga <span class="math inline">\(K\)</span> se suele fijar en 1, y usaremos este como su valor por defecto); los resultados se mostrarán como una gráfica del número de individuos en función del tiempo. Agregaremos una opción para permitir ver los resultados en los últimos pasos de la simulación (por defecto todos los resultados son dibujados).</p>
<pre class="r"><code>ricker &lt;- function(nzero, r, K = 1, tiempo = 100, desde = 0, hasta = tiempo)
{
  N &lt;- numeric(tiempo+1)
  N[1] &lt;- nzero
  for (i in 1:tiempo) N[i+1] &lt;- N[i]*exp(r*(1 - N[i]/K))
  Tiempo &lt;- 0:tiempo
  plot(Tiempo, N, type = &quot;l&quot;, xlim = c(desde, hasta))
}</code></pre>
<p>Utilizemos la función para explorar las propiedades del modelo de Ricker:</p>
<pre class="r"><code>layout(matrix(1:3, 1, 3))
ricker(0.1, 1); title(&quot;r = 1&quot;)
ricker(0.1, 2); title(&quot;r = 2&quot;)
ricker(0.1, 3); title(&quot;r = 3&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/ricker-1.png" alt="Resultados del programa." width="672" />
<p class="caption">
Resultados del programa.
</p>
</div>
</div>
</div>
<div id="analisis-en-r" class="section level1">
<h1>Análisis en <code>R</code></h1>
<p>Vamos a plantear una serie de análisis estadísticos con <code>R</code>, para los cuales vamos a utilizar los datos que vienen por defecto en las instalaciones de <code>R</code>, <code>iris</code>.</p>
<div id="funciones-descriptivas" class="section level2">
<h2>Funciones descriptivas</h2>
<div id="funcion-summary" class="section level3">
<h3>Función <code>summary()</code></h3>
<pre class="r"><code>summary(iris$Sepal.Length)
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   4.300   5.100   5.800   5.843   6.400   7.900
tapply(iris$Sepal.Length,
       INDEX = iris$Species,
       FUN = &quot;summary&quot;)
## $setosa
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   4.300   4.800   5.000   5.006   5.200   5.800 
## 
## $versicolor
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   4.900   5.600   5.900   5.936   6.300   7.000 
## 
## $virginica
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   4.900   6.225   6.500   6.588   6.900   7.900</code></pre>
</div>
<div id="funcion-quantile" class="section level3">
<h3>Función <code>quantile()</code></h3>
<pre class="r"><code>quantile(iris$Sepal.Length)
##   0%  25%  50%  75% 100% 
##  4.3  5.1  5.8  6.4  7.9
quantile(iris$Sepal.Length,
         probs = c(0, 0.2, 0.4, 0.6, 0.8, 1))
##   0%  20%  40%  60%  80% 100% 
## 4.30 5.00 5.60 6.10 6.52 7.90
tapply(iris$Sepal.Length,
       INDEX = iris$Species, 
       FUN = &quot;quantile&quot;)
## $setosa
##   0%  25%  50%  75% 100% 
##  4.3  4.8  5.0  5.2  5.8 
## 
## $versicolor
##   0%  25%  50%  75% 100% 
##  4.9  5.6  5.9  6.3  7.0 
## 
## $virginica
##    0%   25%   50%   75%  100% 
## 4.900 6.225 6.500 6.900 7.900</code></pre>
</div>
<div id="funcion-fivenum" class="section level3">
<h3>Función <code>fivenum()</code></h3>
<p>la función  devuelve los cinco números de Tukey (mínimo, primer cuartil, mediana, tercer cuartil, máximo) de los datos.</p>
<pre class="r"><code>fivenum(iris$Sepal.Length)
## [1] 4.3 5.1 5.8 6.4 7.9
tapply(iris$Sepal.Length,
       INDEX = iris$Species,
       FUN = &quot;fivenum&quot;)
## $setosa
## [1] 4.3 4.8 5.0 5.2 5.8
## 
## $versicolor
## [1] 4.9 5.6 5.9 6.3 7.0
## 
## $virginica
## [1] 4.9 6.2 6.5 6.9 7.9</code></pre>
</div>
<div id="mas-funciones" class="section level3">
<h3>Más funciones</h3>
<p>Hay muchísimas funciones en <code>R</code> que permiten describir una distribución mediante estadísticos: <code>mean()</code>, <code>median()</code>, <code>IQR()</code>, <code>boxplot.stat()</code>, <code>range()</code>, <code>min()</code>, <code>max()</code>, …</p>
<p>Hay otras funciones descriptivas, por ejemplo el coeficiente de asimetría, que no se encuentran en los paquetes básicos …, pero podemos programarlas:</p>
<pre class="r"><code>skewness = function(x) {
    x &lt;- x[!is.na(x)]
    m3 = mean((x-mean(x))^3)
    skew = m3/(sd(x)^3)
    skew
}</code></pre>
</div>
</div>
<div id="distribuciones-de-probabilidad" class="section level2">
<h2>Distribuciones de probabilidad</h2>
<p>Un uso común es proporcionar un amplio conjunto de funciones estadísticas. Las funciones están previstas para evaluar la función de <code>densidad de probabilidad</code>, la función de <code>distribución acumulada</code> <span class="math inline">\(P(X\le x)\)</span> y la función <code>cuantil</code> (dado <span class="math inline">\(q\)</span>, el valor más pequeño <span class="math inline">\(x\)</span> tal que <span class="math inline">\(P(X\le x)&gt; q\)</span>), y simular una distribución.</p>
<p>En general, las funciones de probabilidad en <code>R</code> vienen dadas por el nombre por el que se las conoce en inglés (normal = <code>norm</code>, poisson = <code>pois</code>, binomial = <code>binom</code>, …) y vienen precedidas por un prefijo según los valores a obtener, asì tenemos <code>d</code>, <code>dnorm</code> si queremos valores de una distribución normal, <code>p</code>, <code>pnorm</code> si queremos valores de probabilidad, <code>q</code>, <code>qnorm</code> si queremos valores cuantiles y <code>r</code>, <code>rnorm</code> si queremos valores aleatorios de una distribución normal.</p>
<div id="distribucion-normal" class="section level3">
<h3>Distribución Normal</h3>
<p>Tenemos las siguientes opciones:</p>
<pre class="r"><code>dnorm(x, mean = 0, sd = 1, log = FALSE)
pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)
qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)
rnorm(n, mean = 0, sd = 1)</code></pre>
<pre class="r"><code>dnorm(5, mean = 3, sd = 1)
## [1] 0.05399097
rnorm(5, mean = 5, sd = 5)
## [1]  3.632858  9.676525  1.365184  9.225646 -2.380358</code></pre>
</div>
<div id="distribucion-uniforme" class="section level3">
<h3>Distribución Uniforme</h3>
<p>Tenemos las siguientes opciones:</p>
<pre class="r"><code>dunif(x, min = 0, max = 1, log = FALSE)
punif(q, min = 0, max = 1, lower.tail = TRUE, log.p = FALSE)
qunif(p, min = 0, max = 1, lower.tail = TRUE, log.p = FALSE)
runif(n, min = 0, max = 1)</code></pre>
<pre class="r"><code>runif(6, min = 10, max = 20)
## [1] 16.05887 16.97379 13.60172 15.22898 10.56544 11.19628
qunif(c(0.25, 0.5, 0.75), min = 0, max = 1)
## [1] 0.25 0.50 0.75</code></pre>
</div>
<div id="distribucion-de-poisson" class="section level3">
<h3>Distribución de Poisson</h3>
<p>Tenemos las siguientes opciones:</p>
<pre class="r"><code>dpois(x, lambda, log = FALSE)
ppois(q, lambda, lower.tail = TRUE, log.p = FALSE)
qpois(p, lambda, lower.tail = TRUE, log.p = FALSE)
rpois(n, lambda)</code></pre>
<pre class="r"><code>rpois(6, lambda = 10)
## [1] 13 10  9  9 13  6
qpois(c(0.25, 0.5, 0.75), lambda = 5)
## [1] 3 5 6</code></pre>
</div>
<div id="mas-distribuciones" class="section level3">
<h3>Más distribuciones</h3>
<p>Y así con un montón de distribuciones más: <code>beta</code>, <code>binom</code>, <code>cauchy</code>, <code>chisq</code>, <code>exp</code>, <code>f</code>, <code>gamma</code>, <code>geom</code>, <code>hyper</code>, <code>lnorm</code>, <code>logis</code>, <code>nbinom</code>, <code>t</code>, <code>weibull</code>, <code>wilcox</code>, …</p>
</div>
</div>
<div id="test-estadisticos" class="section level2">
<h2>Test estadísticos</h2>
<div id="dos-muestras" class="section level3">
<h3>Dos muestras</h3>
<p>Uno de los análisis más comunes es la comparación de medias de dos poblaciones. vamos a realizar un an?lisis completo de una muestra en <code>R</code>.</p>
<p>Consideremos el siguiente conjunto de observaciones. Son los tiempos de espera en minutos hasta que nos traen la comida en dos restaurantes:</p>
<ul>
<li><p><strong>Restaurante A</strong>: 1.40 3.23 1.60 0.91 2.28 2.49 0.74 0.51 3.15 2.47</p></li>
<li><p><strong>Restaurante B</strong>: 3.18 1.96 1.89 3.31 3.93 1.91 3.64 2.78 2.48 2.03</p></li>
</ul>
<p>Lo primero, realizamos un análisis gráfico para ver los tiempos en los dos restaurantes.</p>
<pre class="r"><code>A &lt;- c(1.40,3.23,1.60,0.91,2.28,2.49,0.74,0.51,3.15,2.47)
B &lt;- c(3.18,1.96,1.89,3.31,3.93,1.91,3.64,2.78,2.48,2.03)

boxplot(A, B, col = c(&quot;red&quot;, &quot;green&quot;))</code></pre>
<div class="figure" style="text-align: center">
<img src="figuras/manual/boxplot_tiempos_restaurante-1.png" alt="Distribución de los tiempos de espera hasta ser atendido en cada restaurante." width="576" />
<p class="caption">
Distribución de los tiempos de espera hasta ser atendido en cada restaurante.
</p>
</div>
<p>Tras una primera comprobaciòn visual, tenemos que los tiempos de espera no parecen iguales, pero ¿esta diferencia gráfica es significativa?, ¿podemos afirmar que los tiempos son diferentes y que las diferencias no son debidas a la dispersión propia de las medidas?</p>
<p>Para comprobar la igualdad de medias, realizamos un <code>t-test</code> no pareado.</p>
<pre class="r"><code>t.test(A, B, paired = FALSE)
## 
##  Welch Two Sample t-test
## 
## data:  A and B
## t = -2.1067, df = 17, p-value = 0.0503
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.667230785  0.001230785
## sample estimates:
## mean of x mean of y 
##     1.878     2.711</code></pre>
<p>La prueba indica que no hay diferencias significativas, asumiendo normalidad. Nos da un p-valor de 0.0503 por lo que no hay evidencias para rechazar la hipótesis nula <span class="math inline">\(H_{0}\)</span> y aceptamos que la verdadera diferencia de medias es igual a 0, es decir, tardan lo mismo en los dos restaurantes.</p>
<p>Pero … ¿está bien aplicado el test? En la salida del test nos dice <code>Welch Two Sample t-test</code> y es que por defecto <code>R</code> no asume varianzas iguales en las muestras y aplica el <code>test de Welch</code>. Realizamos y <code>test F</code> para probar la igualdad de varianzas.</p>
<pre class="r"><code>var.test(A, B)
## 
##  F test to compare two variances
## 
## data:  A and B
## F = 1.6403, num df = 9, denom df = 9, p-value = 0.4724
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.4074332 6.6039331
## sample estimates:
## ratio of variances 
##           1.640324</code></pre>
<p>La prueba nos da un p-valor de 0.472 por lo que no hay evidencias para rechazar la hipótesis <span class="math inline">\(H_{0}\)</span>, es decir, asumimos que la razón de varianzas es igual a 1.</p>
<p>Por lo tanto, hemos aplicado mal el <code>t-test</code> ya que hemos asumido como hipótesis que ambas muestras tienen varianzas diferentes.</p>
<pre class="r"><code>t.test(A, B, paired = FALSE, var.equal = TRUE)
## 
##  Two Sample t-test
## 
## data:  A and B
## t = -2.1067, df = 18, p-value = 0.04944
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.663714776 -0.002285224
## sample estimates:
## mean of x mean of y 
##     1.878     2.711</code></pre>
<p>Ahora la prueba indica que hay diferencias significativas, asumiendo normalidad. Nos da un p-valor de 0.0494 por lo que hay evidencias para rechazar la hipótesis nula <span class="math inline">\(H_{0}\)</span> y aceptamos que la verdadera diferencia de medias no es igual a 0, es decir, no tardan lo mismo.</p>
<hr />
</div>
</div>
<div id="bibliografia" class="section level2">
<h2>Bibliografía</h2>
<!--
<div id="footer">
<br>
Ibon Martínez Arranz &#149; Calle Santa Eulalia 45, 10ºD 48980 Santurtzi (Bizkaia) &#149;
<br>☎ 626015495 &#149; ☎ 944838823  &#149; ✉ <span class="links"><a href='mailto:ibon.martinez@gmail.com?subject=Contacto a través de curriculum vitae&body=Estimado Ibon,'>ibon.martinez@gmail.com</a></span>
</div>

Ibon Martínez Arranz&nbsp;&nbsp;&nbsp;
<a href="mailto:ibon.martinez@gmail.com"><i class="fa fa-envelope-square fa-2x"></i></a>&nbsp;&nbsp;&nbsp;
<a href="www.google.com"><i class="fa fa-linkedin-square fa-2x"></i>

Ibon Martínez Arranz&nbsp;&nbsp;&nbsp;
<a href="mailto:ibon.martinez@gmail.com"><i class="fa fa-envelope-square fa-2x"></i></a>&nbsp;&nbsp;&nbsp;
<a href="www.google.com"><i class="fa fa-linkedin-square fa-2x"></i>
-->
<div id="footer">
<p>|   Ibon Martínez Arranz   |   2018   |   <a href="mailto:ibon.martinez@imarranz.com">contacto</a>   |</p>
</div>
<div id="refs" class="references">
<div id="ref-altmanslr2015">
<p>Altman, Naomi, and Martin Krzywinski. 2015. “Simple Linear Regression.” <em>Nature Methods</em> 12 (11): 999–1000.</p>
</div>
<div id="ref-altman2016a">
<p>———. 2016a. “Points of Significance: Analyzing Outliers: Influential or Nuisance?” <em>Nature Methods</em> 13 (4): 281–82.</p>
</div>
<div id="ref-altman2016b">
<p>———. 2016b. “Points of Significance: Regression Diagnostics.” <em>Nature Methods</em> 13 (5): 385–86.</p>
</div>
<div id="ref-armitage2014">
<p>Armitage, Emily G., and Coral Barbas. 2014. “Metabolomics in Cancer Biomarker Discovery: Current Trends and Future Perspectives.” <em>J Pharm Biomed Anal</em> 87 (January). Centre for Metabolomics; Bioanalysis (CEMBIO), Faculty of Pharmacy, Universidad San Pablo CEU, Campus Monteprincipe, Boadilla del Monte, 28668 Madrid, Spain.: 1–11. doi:<a href="https://doi.org/10.1016/j.jpba.2013.08.041">10.1016/j.jpba.2013.08.041</a>.</p>
</div>
<div id="ref-miroslava2013">
<p>Čuperlović-Culf, Miroslava. 2013. “5 - Metabolomics Data Analysis – Processing and Analysis of a Dataset.” In <em>{NMR} Metabolomics in Cancer Research</em>, edited by Miroslava Čuperlović-Culf, 261–333. Woodhead Publishing Series in Biomedicine. Woodhead Publishing. doi:<a href="https://doi.org/http://dx.doi.org/10.1533/9781908818263.261">http://dx.doi.org/10.1533/9781908818263.261</a>.</p>
</div>
<div id="ref-fox1997">
<p>Fox, J. 1997. <em>Applied Regression Analysis, Linear Models, and Related Methods</em>. SAGE Publications.</p>
</div>
<div id="ref-krzywinskipostd2014">
<p>Krzywinski, Martin, and Naomi Altman. 2014. “Points of Significance: Two-Factor Designs.” <em>Nature Methods</em> 11 (12): 1187–8.</p>
</div>
<div id="ref-kuehl2001">
<p>Kuehl, R.O., and M.G. Osuna. 2001. <em>Diseño de Experimentos: Principios Estadísticos de Diseño Y análisis de Investigación</em>. Matemáticas (Thomson). International Thomson Editores, S. A. de C. V.</p>
</div>
<div id="ref-martinezarranz2015">
<p>Martínez-Arranz, Ibon, Rebeca Mayo, Miriam Pérez-Cormenzana, Itziar Mincholé, Lorena Salazar, Cristina Alonso, and José M. Mato. 2015. “Enhancing Metabolomics Research Through Data Mining.” <em>Journal of Proteomics</em> 127, Part B (0): 275–88. doi:<a href="https://doi.org/http://dx.doi.org/10.1016/j.jprot.2015.01.019">http://dx.doi.org/10.1016/j.jprot.2015.01.019</a>.</p>
</div>
<div id="ref-murrell2005r">
<p>Murrell, P. 2005. <em>R Graphics</em>. Chapman &amp; Hall/Crc the R Series. CRC Press.</p>
</div>
<div id="ref-pulido2004">
<p>Pulido, H.G., R. de la Vara Salazar, P.G. González, C.T. Martínez, and M.C.T. Pérez. 2004. <em>Análisis Y Diseño de Experimentos</em>. McGraw-Hill.</p>
</div>
<div id="ref-xie2014">
<p>Xie, Yihui. 2014. “Knitr: A Comprehensive Tool for Reproducible Research in R.” In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman; Hall/CRC. <a href="http://www.crcpress.com/product/isbn/9781466561595" class="uri">http://www.crcpress.com/product/isbn/9781466561595</a>.</p>
</div>
<div id="ref-xie2015">
<p>———. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.name/knitr/" class="uri">http://yihui.name/knitr/</a>.</p>
</div>
<div id="ref-xie2016package">
<p>———. 2016. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in R</em>. <a href="http://yihui.name/knitr/" class="uri">http://yihui.name/knitr/</a>.</p>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>En Internet, un espejo, (del inglés, <em>mirror</em>), es un sitio web que contiene una réplica exacta de otro. Estas réplicas u espejos se suelen crear para facilitar descargas grandes y facilitar el acceso a la información aún cuando haya fallos en el servicio del servidor principal.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Del inglés <em>Graphical User Interface</em>.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Los ficheros CSV (del inglés <em>comma-separated values</em>).<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>apply, lapply, mapply, sapply, tapply<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>Importancia de las estructuras de carpetas y ficheros.<a href="#fnref5">↩</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
